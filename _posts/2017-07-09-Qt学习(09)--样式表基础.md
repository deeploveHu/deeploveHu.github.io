---
layout: post
title:  "Qt学习(09)--样式表基础"
categories: Qt
tags:  Qt
author: bloglink
---

* content
{:toc}

QT样式表（QStyleSheet）是一种快速改变QT程序UI风格的方法，它很大程度上借鉴和参考了 HTML 层叠样式表的语法和思想,StyleSheet文件的默认后缀名为qss.可以使用下面的代码导入样式表文件：

    QFile file;
    QString qss;
    file.setFileName("xxx.qss");
    file.open(QFile::ReadOnly);
    qss = QLatin1String(file.readAll());
    qApp->setStyleSheet(qss);




## 一 Box模型
    Qt的Box模型分为四层

    * margin:外边框;
    * border:边框; border-radius可设置圆角
    * padding:内边框;
    * content:box内部

## 二 Sub-controls 子控件模型
一个复杂的 widget 由多个部分组成，它们可以是一个 widget，也可以是逻辑上的部件，例如 QCheckBox 由 icon 和 text 两个部分组成，不仅可以定义 text 的样式，还可以定义icon 相关的样式，icon 部分就是 QCheckBox 的 subcontrol ::indicator。

Subcontrol 的 QSS 和大多数 widget 的差不多，也支持box模型，可以自定义 color, background, background-color, background-image, border, padding, margin, width, height 等

## 三 Pseudo-States 伪状态
伪状态以冒号（:）表示，与css里的伪选择器相似，是基于控件的一些基本状态来限定程序的规则，如hover规则表示鼠标经过控件时的状态，而press表示按下按钮时的状态。如：

    QPushButton:hover {
          Background-color:red;
    }

表示鼠标经过时QPushButton背景变红。

Pseudo还支持否定符号(!)，如：

    QRadioButton:!hover { color: red }

表示没有鼠标移上QRadioButton时他显示的颜色是red。

Pseudo可以被串连在一起，比如：

    QPushButton:hover:!pressed { color: blue; }

表示QPushButton在鼠标移上却没有点击时显示blue字，但如果点击的时候就不会显示blue颜色了。

同样可以和之前所讲的子控件选择器一起联合使用，如：

    QSpinBox::down-button:hover { image: url(btn-combobox-press.bmp) }

## 四 选择器
Qt支持所有的CSS2定义的选择器

* 通用类型选择器：* 会对所有控件有效果。
* 类型选择器：QPushButton匹配所有QPushButton的实例和其子类的实例;
* 属性选择器：QPushButton[flat=”false”]匹配所有QPushButton属性flat为false的实例;
* 类选择器：.QPushButton匹配所有QPushButton的实例，但不包含其子类
* ID选择器：QPushButton#okButton对应Qt里面的object name设置，使用这条CSS之前要先设置对应控件的object name为okButton;
* 后裔选择器：QDialog QPushButton匹配所有为QDialog后裔（包含儿子，与儿子的儿子的递归）为QPushButton的实例;
* 子选择器：QDialog > QPushButton匹配所有的QDialog直接子类QPushButton的实例，不包含儿子的儿子的递归。

## 五 冲突
所有的类型选择器都有一个共同的特性，就是如果有两个属性冲突了的话就会以最后出现的一个为准,如：

    QPushButton { color: red }
    QAbstractButton { color: gray }

由于QPushButton为QAbstractButton的子类，如果只设置QAbstractButton的可以想像结果是所有的 QPushButton都为gray, 如果只设置QPushButton的所有QPushButton都会为red，当两个都能设置起效的时候，以在文本上最后出现的为准，所以结果为 gray

当然其中如果有#指定了object name，他所设置的优先级是最大的,如：

    QPushButton#okButton { color: red }
    QAbstractButton { color: gray }

名称为okButton的QPushButton为red;

Qt自己的帮助文档如下：

For determining the specificity of a rule, Qt Style Sheets follow the CSS2 Specification:

    A selector's specificity is calculated as follows:

    count the number of ID attributes in the selector (= a)
    count the number of other attributes and pseudo-classes in the selector (= b)
    count the number of element names in the selector (= c)
    ignore pseudo-elements [i.e., subcontrols].
    Concatenating the three numbers a-b-c (in a number system with a large base) gives the specificity.

    Some examples:

    *             {}  /* a=0 b=0 c=0 -> specificity =   0 */
    LI            {}  /* a=0 b=0 c=1 -> specificity =   1 */
    UL LI         {}  /* a=0 b=0 c=2 -> specificity =   2 */
    UL OL+LI      {}  /* a=0 b=0 c=3 -> specificity =   3 */
    H1 + *[REL=up]{}  /* a=0 b=1 c=1 -> specificity =  11 */
    UL OL LI.red  {}  /* a=0 b=1 c=3 -> specificity =  13 */
    LI.red.level  {}  /* a=0 b=2 c=1 -> specificity =  21 */
    #x34y         {}  /* a=1 b=0 c=0 -> specificity = 100 */

## 六 附一个我常用的stylesheet

    /*version:0.1 author:link date:2016.12.08 brief:去除选中状态虚线框*/
    QWidget{color:white;font:11pt "Ubuntu Mono";border:none;background:#121922;}
    QWidget:focus{outline:none;}
    /*version:0.1 author:link date:2016.12.08 brief:外边框，标题左上*/
    QGroupBox{border:1px solid #447684;border-radius:2px;margin:10px 0px 0px 0px;}
    QGroupBox::title{subcontrol-origin:margin;subcontrol-position:top left;}
    /*version:0.1 author:link date:2016.12.08 brief:网格线,悬停,选中*/
    QTableWidget{border:1px solid #447684;gridline-color:#447684;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1.0 #212C3F);}
    QTableWidget::item:hover{color:white;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #506B79,stop:1.0 #0D95A6);}
    QTableWidget::item:selected{color:white;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #506B79,stop:1.0 #0D95A6);}
    /*version:0.1 author:link date:2016.12.08 brief:网格线,悬停,选中*/
    QTableView{border:1px solid #447684;gridline-color:#447684;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1.0 #212C3F);}
    QTableView::item:hover{color:white;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #506B79,stop:1.0 #0D95A6);}
    QTableView::item:selected{color:white;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #506B79,stop:1.0 #0D95A6);}
    /*version:0.1 author:link date:2016.12.08 brief:网格线,悬停,选中*/
    QTreeWidget{border:1px solid #447684;gridline-color:#447684;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1.0 #212C3F);}
    QTreeWidget::item:hover{color:white;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #506B79,stop:1.0 #0D95A6);}
    QTreeWidget::item:selected{color:white;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #506B79,stop:1.0 #0D95A6);}
    /*version:0.1 author:link date:2016.12.08 brief:表头,左右内间距*/
    QHeaderView::section{border:1px solid #447684;padding:0px 2px;
    background-color:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #353B43,stop:1 #151A20);}
    /*version:0.1 author:link date:2016.12.08 brief:表头,左右内间距*/
    QTableCornerButton::section{border:1px solid #447684;padding:0px 2px;
    background-color:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #353B43,stop:1 #151A20);}
    /*version:0.1 author:link date:2016.12.23 brief:QCombobox下拉列表字号*/
    QListView{font:15pt;}
    /*version:0.1 author:link date:2016.12.08 brief:边角间距,悬停,按下*/
    QPushButton{border:1px solid #11223F;border-radius:5px;padding:5px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #5B5F5F,stop:0.5 #0C2436,stop:1 #27405A);}
    QPushButton::hover{border-color:#11505C;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #758385,stop:0.5 #122C39,stop:1 #0E7788);}
    QPushButton::pressed{border-color:#11505C;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #969B9C,stop:0.5 #16354B,stop:1 #244F76);}
    /*version:0.1 author:link date:2016.12.08 brief:边角间距,悬停,按下*/
    QToolButton{border:1px solid #11223F;border-radius:5px;padding:5px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #5B5F5F,stop:0.5 #0C2436,stop:1 #27405A);}
    QToolButton::hover{border-color:#11505C;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #758385,stop:0.5 #122C39,stop:1 #0E7788);}
    QToolButton::pressed{border-color:#11505C;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #969B9C,stop:0.5 #16354B,stop:1 #244F76);}
    /*version:0.1 author:link date:2016.12.08 brief:边角间距,最小宽高,悬停,按下*/
    QTabBar::tab{border:1px solid #447684;min-width:55px;min-height:20px;padding:3px 8px 3px 8px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #5B5F5F,stop:0.5 #0C2436,stop:1 #27405A);}
    QTabBar::tab::hover{border-color:#11505C;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #758385,stop:0.5 #122C39,stop:1 #0E7788);}
    QTabBar::tab:selected{border-color:#11505C;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #969B9C,stop:0.5 #16354B,stop:1 #244F76);}
    /*version:0.1 author:link date:2016.12.08 brief:图标*/
    QRadioButton::indicator::unchecked{image:url(:/source/check_box_1.png);}
    QRadioButton::indicator::checked{image:url(:/source/check_box_2.png);}
    /*version:0.1 author:link date:2016.12.08 brief:图标*/
    QCheckBox::indicator::unchecked {image:url(:/source/check_box_1.png);}
    QCheckBox::indicator::checked {image:url(:/source/check_box_2.png);}
    /*version:0.1 author:link date:2016.12.08 brief:边框,选中,背景,图标*/
    QComboBox {border:1px solid #32435E;border-radius:3px;padding:3px;font:12pt;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1 #212C3F);
    selection-background-color:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #506B79,stop:1.0 #0D95A6);}
    QComboBox::drop-down{width:16px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #5B5F5F,stop:0.5 #0C2436,stop:1 #27405A);}
    QComboBox::down-arrow{image:url(:/source/down_arrow.png);}
    QComboBox QAbstractItemView::item{min-height:35px;}
    /*version:0.1 author:link date:2016.12.08 brief:边框,边角,背景,上下按钮,图标*/
    QTimeEdit{border:1px solid #32435E;border-radius:3px;padding:3px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1 #212C3F);}
    QTimeEdit::drop-down{width:16px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #5B5F5F,stop:0.5 #0C2436,stop:1 #27405A);}
    QTimeEdit::down-arrow{image:url(:/source/down_arrow.png);}
    QTimeEdit::up-arrow{image:url(:/source/up_arrow.png);}
    /*version:0.1 author:link date:2016.12.08 brief:边框,边角,背景,上下按钮,图标*/
    QDateEdit{border:1px solid #32435E;border-radius:3px;padding:3px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1 #212C3F);}
    QDateEdit::drop-down{width:16px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #5B5F5F,stop:0.5 #0C2436,stop:1 #27405A);}
    QDateEdit::down-arrow{image:url(:/source/down_arrow.png);}
    QDateEdit::up-arrow{image:url(:/source/up_arrow.png);}
    /*version:0.1 author:link date:2016.12.08 brief:边框,边角,背景*/
    QLineEdit{border:1px solid #447684;border-radius:3px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1.0 #212C3F);}
    /*version:0.1 author:link date:2016.12.08 brief:边框,边角,背景*/
    QTextEdit{border:1px solid #447684;border-radius:3px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1.0 #212C3F);}
    /*version:0.1 author:link date:2016.12.08 brief:边框,边角,背景*/
    QPlainTextEdit{border:1px solid #447684;border-radius:3px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1.0 #212C3F);}
    /*version:0.1 author:link date:2016.12.08 brief:边框,边角,背景,上下按钮,图标*/
    QSpinBox{border:1px solid #32435E;border-radius:3px;padding:3px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1 #212C3F);}
    QSpinBox::down-button,QSpinBox::up-button{width:16px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #5B5F5F,stop:0.5 #0C2436,stop:1 #27405A);}
    QSpinBox::down-arrow{image:url(:/source/down_arrow.png);}
    QSpinBox::up-arrow{image:url(:/source/up_arrow.png);}
    /*version:0.1 author:link date:2016.12.08 brief:边框,边角,背景,上下按钮,图标*/
    QDoubleSpinBox{border:1px solid #32435E;border-radius:3px;padding:3px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1 #212C3F);}
    QDoubleSpinBox::down-button,QDoubleSpinBox::up-button{width:0px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #5B5F5F,stop:0.5 #0C2436,stop:1 #27405A);}
    QDoubleSpinBox::down-arrow{image:url(:/source/down_arrow.png);}
    QDoubleSpinBox::up-arrow{image:url(:/source/up_arrow.png);}
    /*version:0.1 author:link date:2016.12.08 brief:边框,边角,背景,上下按钮,图标*/
    QDateTimeEdit{border:1px solid #32435E;border-radius:3px;padding:3px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1 #212C3F);}
    QDateTimeEdit::drop-down{width:16px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #5B5F5F,stop:0.5 #0C2436,stop:1 #27405A);}
    QDateTimeEdit::down-button,QDateTimeEdit::up-button{width:16px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #5B5F5F,stop:0.5 #0C2436,stop:1 #27405A);}
    QDateTimeEdit::down-arrow{image:url(:/source/down_arrow.png);}
    QDateTimeEdit::up-arrow{image:url(:/source/up_arrow.png);}
    /*version:0.1 author:link date:2016.12.08 brief:边框,背景,左右按钮,图标*/
    QScrollBar:horizontal{border:1px solid #32435E;background:#21252F;margin:0px 12px;}
    QScrollBar::handle:horizontal{background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #60788C,stop:1 #1084BD);}
    QScrollBar::add-line:horizontal{border:1px solid #32435E;width:12px;subcontrol-position:left;subcontrol-origin:margin;}
    QScrollBar::sub-line:horizontal{border:1px solid #32435E;width:12px;subcontrol-position:right;subcontrol-origin:margin;}
    QScrollBar::add-page:horizontal,QScrollBar::sub-page:horizontal {background:none;}
    /*version:0.1 author:link date:2016.12.08 brief:边框,背景,左右按钮,图标*/
    QScrollBar:vertical{border:1px solid #32435E;background:#21252F;margin:12px 0px;}
    QScrollBar::handle:vertical{background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #60788C,stop:1 #1084BD);}
    QScrollBar::add-line:vertical{border:1px solid #32435E;width:12px;subcontrol-position:top;subcontrol-origin:margin;}
    QScrollBar::sub-line:vertical{border:1px solid #32435E;width:12px;subcontrol-position:bottom;subcontrol-origin:margin;}
    QScrollBar::add-page:vertical,QScrollBar::sub-page:vertical {background:none;}
    /*version:0.1 author:link date:2016.12.08 brief:待处理*/
    QSlider::groove:horizontal,QSlider::add-page:horizontal{height:8px;border-radius:3px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #2F81A6,stop:1.0 #5DABD5);}
    QSlider::handle:horizontal{width:13px;margin-top:-3px;margin-bottom:-3px;border-radius:6px;
    background:qradialgradient(spread:pad,cx:0.5,cy:0.5,radius:0.5,fx:0.5,fy:0.5,stop:0.6 #DAEFFF,stop:0.8 #C0DEF6);}
    QSlider::groove:vertical,QSlider::sub-page:vertical{width:8px;border-radius:3px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #2F81A6,stop:1.0 #5DABD5);}
    QSlider::handle:vertical{height:13px;margin-left:-2px;margin-right:-3px;border-radius:6px;
    background:qradialgradient(spread:pad,cx:0.5,cy:0.5,radius:0.5,fx:0.5,fy:0.5,stop:0.6 #DAEFFF,stop:0.8 #C0DEF6);}
    /*version:0.1 author:link date:2016.12.08 brief:文字,边框,边角,背景,滚动条*/
    QProgressBar{text-align:center;border:1px solid #C0DCF2;border-radius:5px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1.0 #212C3F);}
    QProgressBar::chunk{
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #506B79,stop:1.0 #0D95A6);}
    /*version:0.1 author:link date:2016.12.08 brief:颜色,边框,边角,背景,滚动条*/
    QLCDNumber{color:red;border:1px solid #447684;border-radius:3px;
    background:qlineargradient(x1:0,y1:0,x2:0,y2:1,stop:0 #080B10,stop:1.0 #212C3F);}
    /*Other*/
    QDialog QPushButton{min-height:25px;min-width:60px;}
